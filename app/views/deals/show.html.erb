<h1 class="text-2xl font-bold mb-4"><%= @deal.title %></h1>

<p><strong>Company:</strong> <%= @deal.company.name %></p>
<p><strong>Contact:</strong> <%= @deal.contact.name %></p>
<p><strong>Value:</strong> <%= number_to_currency(@deal.value) %></p>
<p><strong>Stage:</strong> <%= @deal.stage.name %></p>
<p><strong>Probability:</strong> <%= @deal.probability %>%</p>
<p><strong>Close Date:</strong> <%= @deal.close_date %></p>
<p><strong>Created At:</strong> <%= @deal.created_at.strftime("%B %d, %Y") %></p>

<div class="my-4">
  <%= link_to "Edit Deal", edit_deal_path(@deal), class: "text-blue-600 underline mr-4" %>
  <%= link_to "Back to Kanban", kanban_deals_path, class: "text-gray-600 underline" %>
</div>

<hr class="my-6">

<h2 class="text-xl font-bold mb-2">Deal Tasks</h2>

<% if @deal_tasks.any? %>
  <% @deal.tasks.each do |task| %>
  <div id="<%= dom_id(task) %>" class="border p-2 rounded mb-2 bg-gray-50">
    <p><strong>Title:</strong> <%= task.title %></p>
    <p><strong>Due Date:</strong> <%= task.due_date %></p>
    <p><strong>Status:</strong> <%= task.status %></p>

    <div class="mt-2">
      <%= link_to "🔍 Show", task_path(task), class: "text-green-600 hover:underline mr-3" %>
      <%= link_to "✏️ Edit", edit_deal_task_path(@deal, task), class: "text-blue-600 hover:underline mr-3" %>
    <%= button_to "🗑️ Delete", deal_task_path(@deal, task),
              method: :delete,
              form: { data: { turbo_confirm: "Are you sure?" } },
              class: "text-red-600 hover:underline bg-transparent border-none p-0" %>
    </div>
  </div>
<% end %>

<% else %>
  <p class="text-gray-500 italic">No tasks assigned to this deal yet.</p>
<% end %>


<hr class="my-6">

<h2 class="text-lg font-semibold mb-3">Tasks</h2>

<%= link_to "➕ Add Task", new_deal_task_path(@deal),
            class: "inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition" %>
